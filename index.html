<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{{ channel }} in {{ group }} :: Bonfire</title>
    <!-- <title>#channel in GroupName :: Bonfire</title> -->
    <!-- <title>@username@instance.tld :: Bonfire</title> -->

    <link data-trunk rel="css" href="src/style.css">

    <link href="https://cdn.jsdelivr.net/gh/StephanWagner/jBox@v1.3.2/dist/jBox.all.min.css" rel="stylesheet">

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Atkinson+Hyperlegible:ital,wght@0,400;0,700;1,400;1,700&family=Noto+Sans:ital,wght@0,400;0,700;1,400;1,700&display=swap" rel="stylesheet">
</head>
<style>

body { 
    background-color: rgb(30, 30, 46);
}

</style>
<body>

<script>
document.onclick = hideMenu; 
document.oncontextmenu = rightClick; 

window.contextMenuCoordinates = [];

// Sets a timer for a few frames to allow the page to load before checking
let checkForBoxTimer = setTimeout(connectMessageBox, 10);

// Connects the message box from rust to the DOM so we are able to read input, if it fails, trys again in a few frames.
function connectMessageBox() {
    try {
        const message_box = document.getElementById("message-box");

        message_box.oninput = function(e) {
            if ((message_box.innerHTML == "<br>") || (message_box.innerHTML == "<div><br></div>")) {
                message_box.innerHTML = "";
            }
        } 
        clearTimeout(checkForBoxTimer);
    } catch (error) {
        console.log("Message box not found: " + error + "\nTrying again...");
        checkForBoxTimer = setTimeout(connectMessageBox, 10);
    }
}

function hideMenu() { 
    document.getElementById("contextMenu") 
            .style.display = "none" 
} 

function rightClick(e) { 
    if (document.getElementById("contextMenu").style.display == "block") { 

        // if you right click again when the menu is open, check to see 
        // if the location was within 20 pixels of its current location. 
        // If so: Don't re-open it, allow the  defult context meny. 
        // If not: do the standard behavor of close/open.
        if ((e.pageX > contextMenuCoordinates[0] + 20) || 
            (e.pageX < contextMenuCoordinates[0] - 20) || 

            (e.pageY > contextMenuCoordinates[1] + 20) || 
            (e.pageY > contextMenuCoordinates[1] + 20)) { 
            e.preventDefault();
            hideMenu(); 
        } 
    } else { 
        e.preventDefault(); 

        var menu = document.getElementById("contextMenu")
        menu.style.display = 'block'; 
        menu.style.marginLeft = e.pageX + "px"; 
        menu.style.marginTop = e.pageY + "px"; 
    }

    contextMenuCoordinates[0] = e.pageX;
    contextMenuCoordinates[1] = e.pageY;
} 
</script>

<script src="https://unpkg.com/@popperjs/core@2"></script>
<script src="https://unpkg.com/tippy.js@6"></script>
<script>
let checkForNewTooltips = setTimeout(renderTooltips, 50);

function renderTooltips() { 
    // With the above scripts loaded, you can call `tippy()` with a CSS
    // selector and a `content` prop:

    tippy('.has-tooltip', {
        content: 'My tooltip!',
        animation: 'fade',
        theme: 'dark',
        placement: 'right',
    });

    // checkForNewTooltips = setTimeout(renderTooltips, 50);
}
</script>
</body>
</html>